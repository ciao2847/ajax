<!-- <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />

    <title>React App</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
 -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />

    <title>非同步請求流程控制 callback promise Async/Await</title>
    <script>
      //Callback回呼函式
      /*  function delayedAdd(n1, n2, dalayedTime, callback) {
        //設定排程，延遲一段時間後執行
        window.setTimeout(function () {
          //延遲一段時間之後，計算加法，呼叫Callback函式
          callback(n1 + n2);
        }, dalayedTime);
      }
      function test() {
        delayedAdd(3, 4, 2000, function (result) {
          console.log(result);
        });
      } */
      //Promise物件
      /*
      function delayedAdd(n1, n2, dalayedTime, callback) {
        //建立Promise物件:new Promise(執行函式)
        return new Promise(function (resolve, reject) {
          window.setTimeout(function () {
            resolve(n1 + n2); //工作完成，呼叫resolve函式，並把結果透過參數傳遞進去
          }, dalayedTime);
        });
      }
      function test() {
        let promise1 = delayedAdd(3, 4, 2000);
        let promise2 = delayedAdd(2, 3, 3000);
        //多個Promise都完成後，才繼續工作
        Promise.all([promise1, promise2]).then(function (results) {
          let answer = results.reduce(function (total, value) {
            return total * value;
          });
          console.log(answer);
        });
      }*/
      //Async/Await語法，簡化Promise語法
      function delayedAdd(n1, n2, dalayedTime, callback) {
        //建立Promise物件:new Promise(執行函式)
        return new Promise(function (resolve, reject) {
          window.setTimeout(function () {
            resolve(n1 + n2); //工作完成，呼叫resolve函式，並把結果透過參數傳遞進去
          }, dalayedTime);
        });
      }
      async function test() {
        let result1 = await delayedAdd(3, 4, 2000);
        let result2 = await delayedAdd(2, 3, 3000);
        let answer = result1 * result2;
        console.log(answer);
      } //前提是有使用Promise物件材能使用Async/Await語法
    </script>
  </head>
  <body>
    <h3>非同步請求流程控制 callback promise Async/Await</h3>
    <button onclick="test();" style="padding: 10px 30px">Test</button>
  </body>
</html>
